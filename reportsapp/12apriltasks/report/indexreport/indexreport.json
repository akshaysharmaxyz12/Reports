{
 "add_total_row": 0,
 "columns": [],
 "creation": "2024-04-12 14:08:29.342675",
 "disabled": 0,
 "docstatus": 0,
 "doctype": "Report",
 "filters": [],
 "idx": 0,
 "is_standard": "Yes",
 "letter_head": "test letter head",
 "letterhead": null,
 "modified": "2024-04-12 14:32:10.535732",
 "modified_by": "Administrator",
 "module": "12apriltasks",
 "name": "indexreport",
 "owner": "Administrator",
 "prepared_report": 0,
 "query": "import frappe\n\ndef create_indexes():\n    frappe.db.sql(\"CREATE INDEX binidx ON `tabBin` (item_code, warehouse, actual_qty)\")\n\n    frappe.db.sql(\"CREATE INDEX Warehouseidx ON `tabWarehouse` (warehouse_name)\")\n\ndef get_stock_data(item_code):\n    sql_query = \"\"\"\n        SELECT \n            b.item_code,\n            b.warehouse,\n            b.actual_qty AS bin_qty,\n            w.warehouse_name\n        FROM \n            `tabBin` b\n        INNER JOIN \n            `tabWarehouse` w ON b.warehouse = w.name\n        WHERE \n            b.item_code = %s\n    \"\"\"\n\n    # Execute the SQL query with item_code parameter\n    stock_data = frappe.db.sql(sql_query, (item_code,), as_dict=True)\n    return stock_data\n\n# Main function to demonstrate usage\ndef main():\n    # Create indexes\n    create_indexes()\n\n    # Test retrieving stock data for a specific item code\n    item_code = '0005'\n    stock_data = get_stock_data(item_code)\n    print(stock_data)\n\nif __name__ == \"__main__\":\n    main()",
 "ref_doctype": "Stock Entry",
 "report_name": "indexreport",
 "report_type": "Script Report",
 "roles": []
}